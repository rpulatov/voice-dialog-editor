{
  "type": "object",
  "properties": {
    "dialogName": {
      "type": "string",
      "minLength": 3,
      "title": "Наименивание диалога",
      "description": "Введите наименивание диалога"
    },
    "levels": {
      "title": "Уровни",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "title": {
            "title": "Наименование уровня",
            "type": "string"
          },
          "levelNum": {
            "title": "Номер уровня",
            "type": "number"
          },
          "description": {
            "title": "Описание",
            "type": "string"
          },
          "topic": {
            "title": "Что говорит робот",
            "description": "Что должен говорить робот при переходе на данный уровень",
            "type": "string"
          },
          "track": {
            "$ref": "#/definitions/track"
          },
          "needExceptCall": {
            "title": "Необходимо прервать звонок",
            "description": "Экстренное прерывание звонка",
            "type": "boolean"
          },
          "needCompleteCall": {
            "title": "Необходимо завершить звонок",
            "description": "Плановое прерывание звонка",
            "type": "boolean"
          },
          "actor": {
            "type": "object",
            "properties": {
              "actions": {
                "title": "Действия",
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "actionKeywords": {
                      "title": "Слова триггеры",
                      "type": "string"
                    },
                    "onAction": {
                      "title": "Переход на уровень",
                      "type": "number"
                    }
                  },
                  "required": ["actionKeywords", "onAction"]
                }
              },
              "exceptionKeywords": {
                "title": "Ключевые слова прерывающие звонок",
                "description": "Плановое прерывание звонка",
                "type": "string"
              },
              "mindKeywords": {
                "title": "Ключевые слова продлевающие звонок",
                "description": "",
                "type": "string"
              },
              "onExcept": {
                "title": "Переход на уровень",
                "type": "number"
              },
              "mindInterval": {
                "title": "Время ожидания осмысленных фраз (сек)",
                "type": "number",
                "maximum": 30,
                "minimum": 1
              },
              "silenceInterval": {
                "title": "Время тишины (сек)",
                "type": "number",
                "maximum": 30,
                "minimum": 1
              },
              "onSilence": {
                "title": "Переход на уровень",
                "type": "number"
              },
              "onUnMind": {
                "title": "Переход на уровень",
                "type": "number"
              }
            },
            "required": ["actions", "exceptionKeywords"]
          }
        },
        "required": ["title", "topic", "description", "actor"]
      }
    },
    "goals": {
      "title": "Цели",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "title": "Наименование цели",
            "type": "string"
          },
          "steps": {
            "title": "Шаги",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "title": "Наименование шага",
                  "type": "string"
                },
                "dialogLevel": {
                  "title": "Уровни диалога на которых достагается шаг (номера через запятую)",
                  "type": "string"
                },
                "increment": {
                  "title": "На сколько увеличить % достигнутости цели (в поцентах)",
                  "type": "number"
                },
                "decrement": {
                  "title": "На сколько уменьшить % достигнутости цели (в поцентах)",
                  "type": "number"
                },
                "definitelyValue": {
                  "title": "Установить значение % достигнутости",
                  "type": "number"
                },
                "checkPatterns": {
                  "title": "Шаблоны проверки данных",
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["NumbersPattern", "PhonePattern"]
                  }
                },
                "onPatternMismatch": {
                  "title": "Перейти на уровень при несоответствии шаблонам",
                  "type": "number"
                }
              }
            }
          }
        }
      }
    }
  },
  "required": ["dialogName"]
}
